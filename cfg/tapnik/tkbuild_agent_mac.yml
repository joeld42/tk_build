---
# Config file for tkbuild worker/agent node
build-agent:
  name: pareidolia
  desc: Joel macbook build agent
  gcloud:
    credfile: /Users/joeld/cfg/firestore-key.json
    project-id: rising-environs-295900
  
projects:

  - project:
      projectId: tkwordlist
      projectDir: "/opt/tkbuild/tk_wordlist/"
      workDir: "/opt/tkbuild/tk_wordlist/workdir"
      icon: "/imgs/icon_tkwordlist_167.png"
      jobDeleteAge: 1440
      sortKey: 2
      worksteps:
        - name: "fetch"
          repoUrl: "https://github.com/joeld42/tk_wordlist.git"          
        - name: "build"
          cmd: "$TKBUILD/tkwordlist_build.sh $WORKDIR"

  - project:
      projectId: testrepo
      projectDir: "/opt/tkbuild/testrepo/"
      icon: "/imgs/icon_testrepo_167.png"
      bucketName: tkbuild-artifacts
      jobDeleteAge: 1440
      sortKey: 3
      worksteps:
        - name: "fetch"
          repoUrl: "https://github.com/joeld42/testrepo.git"
          cmd: "echo will do extra fetch stuff here"
        - name: "build"
          cmd: "$TKBUILD/testrepo_build.sh $WORKDIR $COMMIT $BUILDNUM"
          peekVersion : "$WORKDIR/version.txt"
        - name: "package"          
          cmd: "$TKBUILD/testrepo_package.sh $WORKDIR $VERSION $BUILDNUM"
          artifact: "$WORKDIR/testrepo_$VERSION_build_$BUILDNUM.zip"

  - project:
      projectId: civclicker
      projectDir: "/opt/tkbuild/civclicker"
      icon: "/imgs/icon_civclicker_167.png"
      bucketName: tkbuild-artifacts
      jobDeleteAge: 10080
      sortKey: 1
      worksteps:
        - name: "fetch"
          repoUrl: "https://github.com/joeld42/civclicker.git"
          cmd: "$TKBUILD/civclicker_fetch.sh $WORKDIR"
        - name: "build"
          cmd: "$TKBUILD/civclicker_build.sh $WORKDIR $COMMIT $BUILDNUM"
          peekVersion : "$WORKDIR/version.txt"
        - name: "package"
          cmd: "$TKBUILD/civclicker_package.sh $WORKDIR $VERSION $BUILDNUM"
          artifact: "$WORKDIR/export/civclicker_$VERSION_$BUILDNUM.ipa"
      cleanupDirs:
        - $PROJWORKDIR/fips-build/$WORKNAME
        - $PROJWORKDIR/fips-deploy/$WORKNAME